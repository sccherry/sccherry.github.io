<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Frequency bar graph (with Vue, D3, and Rxjs) | Cherry on Top</title><meta name="description" content="Frequency bar graph (with Vue, D3, and Rxjs) October 2, 2017 &amp;lt;div id=&quot;app&quot;&gt; &amp;lt;p&gt;Click document to start&amp;lt;/p&gt; &amp;lt;bar-chart width=&quot;960&quot; height=&quot;600&quot;..."><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="apple-touch-startup-image" href="/assets/android-chrome-192x192.png"><link rel="icon" type="image/png" href="/assets/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/assets/favicon-16x16.png" sizes="16x16"><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#2b8a3e"><link rel="shortcut icon" href="/assets/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cherry on Top"><meta name="theme-color" content="#2b8a3e"><meta name="application-name" content="Cherry on Top"><meta name="msapplication-TileColor" content="#2b8a3e"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="/css/main.css"><link rel="canonical" href="https://stevecherry.net/2017/10/02/frequency-bar-graph-with-vue-d3-and-rxjs/"><link rel="alternate" type="application/rss+xml" title="Cherry on Top" href="/feed.xml"></head><body class="font-sans text-default flex flex-col min-h-screen max-w-xl mx-auto px-3" prefix="schema: http://schema.org/"><header role="banner"><h1><a href="/" class="text-primary no-underline">Cherry on Top</a></h1></header><nav role="navigation"><ul class="flex"><li class=""><a href="/about/">About</a></li><li class="ml-3"><a href="/resume/">Résumé</a></li></ul></nav><main class="flex-1" role="main"><article><header><h2>Frequency bar graph (with Vue, D3, and Rxjs)</h2><time datetime="2017-10-02T00:00:00.000Z">October 2, 2017</time></header><div class="longform"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Click document to start<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bar-chart</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>960<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>600<span class="token punctuation">"</span></span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>frequencies<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bar-chart</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar-chart<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">:view-box.camel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewBox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar in bars<span class="token punctuation">"</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">html</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br>  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">p</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">#app</span> <span class="token punctuation">{</span><br>  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> interpolateRainbow<span class="token punctuation">,</span> range<span class="token punctuation">,</span> scaleBand<span class="token punctuation">,</span> scaleLinear<span class="token punctuation">,</span> scalePow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://cdn.skypack.dev/d3@^5.16.0'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> animationFrame<span class="token punctuation">,</span> interval<span class="token punctuation">,</span> <span class="token keyword">of</span><span class="token punctuation">,</span> Scheduler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://cdn.skypack.dev/rxjs@^6.5.5'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> map<span class="token punctuation">,</span> mergeMap<span class="token punctuation">,</span> tap<span class="token punctuation">,</span> withLatestFrom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https://cdn.skypack.dev/rxjs@^6.5.5/operators'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.esm.browser.min.js'</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Global variables<br> */</span><br><br><span class="token keyword">const</span> <span class="token constant">MIN_FREQ</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">MAX_FREQ</span> <span class="token operator">=</span> <span class="token number">6000</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">NUM_BARS</span> <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">FFT_SIZE</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">CONTEXT</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Utility functions<br> */</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">average</span> <span class="token operator">=</span> <span class="token parameter">list</span> <span class="token operator">=></span> list<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> nToFreq <span class="token operator">=</span> <span class="token function">scalePow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">exponent</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NUM_BARS</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">MIN_FREQ</span><span class="token punctuation">,</span> <span class="token constant">MAX_FREQ</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> freqToBin <span class="token operator">=</span> <span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">CONTEXT</span><span class="token punctuation">.</span>sampleRate <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">FFT_SIZE</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">BIN_LOWER</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token function">freqToBin</span><span class="token punctuation">(</span><span class="token constant">MIN_FREQ</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">BIN_UPPER</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token function">freqToBin</span><span class="token punctuation">(</span><span class="token constant">MAX_FREQ</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Use a power scale to group bins into equal pitch ranges</span><br><span class="token keyword">const</span> <span class="token function-variable function">nToBin</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=></span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token function">freqToBin</span><span class="token punctuation">(</span><span class="token function">nToFreq</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token constant">BIN_LOWER</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">aggregate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> num</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token function">nToBin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token function">nToBin</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token function">average</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>lowerBound<span class="token punctuation">,</span> upperBound<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Vue<br> */</span><br><br><span class="token keyword">const</span> BarChart <span class="token operator">=</span> <span class="token punctuation">{</span><br>  template<span class="token operator">:</span> <span class="token string">'#bar-chart'</span><span class="token punctuation">,</span><br>  props<span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token string">'data'</span><span class="token punctuation">,</span><br>    <span class="token string">'width'</span><span class="token punctuation">,</span><br>    <span class="token string">'height'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">]</span><span class="token punctuation">,</span><br>  computed<span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token function">bars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> len <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br><br>      <span class="token keyword">const</span> xScale <span class="token operator">=</span> <span class="token function">scaleBand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token function">range</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">rangeRound</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">paddingInner</span><span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">const</span> yScale <span class="token operator">=</span> <span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">]</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TODO don't hardcode this value</span><br><br>      <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token punctuation">{</span><br>          x<span class="token operator">:</span> <span class="token function">xScale</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><br>          y<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">-</span> <span class="token function">yScale</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span><br>          width<span class="token operator">:</span> xScale<span class="token punctuation">.</span><span class="token function">bandwidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>          height<span class="token operator">:</span> <span class="token function">yScale</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span><br>          fill<span class="token operator">:</span> <span class="token function">interpolateRainbow</span><span class="token punctuation">(</span>i <span class="token operator">/</span> len<span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function">viewBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">0 0 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Audio<br> */</span><br><br><span class="token keyword">const</span> analyser <span class="token operator">=</span> <span class="token constant">CONTEXT</span><span class="token punctuation">.</span><span class="token function">createAnalyser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>analyser<span class="token punctuation">.</span>fftSize <span class="token operator">=</span> <span class="token constant">FFT_SIZE</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> dataArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>analyser<span class="token punctuation">.</span>frequencyBinCount<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> microphone <span class="token operator">=</span> <span class="token keyword">of</span><span class="token punctuation">(</span>navigator<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><br>  <span class="token function">mergeMap</span><span class="token punctuation">(</span><span class="token parameter">nav</span> <span class="token operator">=></span> nav<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> audio<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> video<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> mediaStream <span class="token operator">=</span> microphone<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><br>  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">stream</span> <span class="token operator">=></span> <span class="token constant">CONTEXT</span><span class="token punctuation">.</span><span class="token function">createMediaStreamSource</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">source</span> <span class="token operator">=></span> source<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>analyser<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> animationFrame$ <span class="token operator">=</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> animationFrame<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> frequencyData <span class="token operator">=</span> animationFrame$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><br>  <span class="token function">withLatestFrom</span><span class="token punctuation">(</span>mediaStream<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>frame<span class="token punctuation">,</span> source<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    analyser<span class="token punctuation">.</span><span class="token function">getByteFrequencyData</span><span class="token punctuation">(</span>dataArray<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token function">aggregate</span><span class="token punctuation">(</span>dataArray<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token constant">BIN_LOWER</span><span class="token punctuation">,</span> <span class="token constant">BIN_UPPER</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NUM_BARS</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * App<br> */</span><br><br><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span><br>  data<span class="token operator">:</span> <span class="token punctuation">{</span><br>    frequencies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  components<span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token string">'bar-chart'</span><span class="token operator">:</span> BarChart<span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>frequencyData<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  vm<span class="token punctuation">.</span>frequencies <span class="token operator">=</span> data<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">resumeAudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token constant">CONTEXT</span><span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> resumeAudioContext<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> resumeAudioContext<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><div class="h-0 overflow-hidden pt-9/16 relative border border-solid border-default"><iframe src="embed.html" class="absolute top-0 left-0 w-full h-full"></iframe></div></div></article></main><footer class="border-0 border-solid border-primary border-t mb-6 pt-6" role="contentinfo"><p>The online home of Steve Cherry.</p><ul class="list-none pl-0 flex"><li><a href="/feed.xml" class="hover:text-rss focus:text-rss">Feed</a></li><li class="ml-3"><a href="mailto:stevenccherry@gmail.com">Email</a></li><li class="ml-3"><a href="https://github.com/sccherry" class="hover:text-github focus:text-github">Github</a></li><li class="ml-3"><a href="https://codepen.io/sccherry" class="hover:text-codepen focus:text-codepen">Codepen</a></li></ul></footer><script src="/js/pjax.js" defer="defer"></script><script src="/js/main.js" defer="defer"></script></body></html>